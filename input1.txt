-- Schema Definitions --
Employee(
  Fname, Minit, Lname, Ssn, Bdate, Address, Sex, Salary, Super_ssn, Dno,
  PRIMARY KEY(Ssn)
);

Project(
  Pname, Pnumber, Plocation, Dnum,
  PRIMARY KEY(Pnumber),
  UNIQUE(Pname)
);

Works_On(
  Essn, Pno, Hours,
  PRIMARY KEY(Essn, Pno)
); 

-- SQL Query --
-- For each department, compute salary and workload statistics: 

SELECT
  E.Dno, 
  COUNT(*), 
  MIN(E.Salary), 
  MAX(E.Salary), 
  AVG(E.Salary), 
  SUM(W.Hours), 
  AVG(W.Hours) 
FROM 
  Employee E 
  LEFT OUTER JOIN Works_On W ON E.Ssn = W.Essn 
GROUP BY 
  E.Dno 
HAVING 
  AVG(E.Salary) >= 60000 AND 
  AVG(E.Salary) <= 90000; 